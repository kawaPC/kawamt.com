---
title: ブログを作る⑤ - "続きを読む"の実装
---

![記事ソースのMarkdownファイル](https://cdn-ak.f.st-hatena.com/images/fotolife/h/hachipochi/20210722/20210722184351.png "記事の元になったMarkdownファイル")

これはブログサービスでは馴染みの機能で、ざっくり言うと

「"続きを読む"のリンクを踏むと記事単体ページに飛び、一覧では隠れていた記事の本文が表示される」

というものだ。

このサイトの実装の場合、記事ファイルはただの一つのMarkdownファイルなので、ひと工夫が必要だった。

***

### 前文と本文を分ける記号を決める

Markdownには水平線(horizontal)を引く記法がいくつかある。
おそらく`---`を使う人が多いと思うが、これ以外にも`***`や`- - -`といった書き方もできる。

自分も基本的には`---`を使うので、代わりに`***`を改ページの記号として扱うことにした。

### 前文だけが載った記事一覧を作る

`split`で前文と本文に分け、前者を渡してビルドにかければ、簡単に前文だけが表示される記事一覧を作ることができる。

```ts
// `***`を分岐点に前文と本文を分け、前文だけをRemarkの変換にかけて記事一覧へ出力する
const [introduction, body] = content.split("***");
const introductionSource = await markdownToHtml(introduction);

// "続きを読む"のリンクを表示するかどうかのフラグに使う
const isShort = !body
```

また、改ページ記号がなければ、`introduction`に全文が入ることになり、"続きを読む"がない、短い記事が生成される。

### 記事単体ページでは水平線として表示される

改ページの記号に`***`を選んだ理由はもう一つある。

記事単体ページでは全文を表示する関係で、改ページの記号として使った`***`も内容として入ってきてしまうのだが、
Markdown的に`***`は水平線として処理されるので、これはこれで前文と本文の境目が分かりやすくなって都合が良い。

![記事ページでは水平線として表示される](https://cdn-ak.f.st-hatena.com/images/fotolife/h/hachipochi/20210722/20210722145957.png "記事ページでは水平線として表示される")

思いつきでやった割には良い感じに収まってくれたかなと思う。
